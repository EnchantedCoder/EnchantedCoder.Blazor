@page "/EcGrid_Issue118_Test"
@using System.Globalization

<h1>Issue 118</h1>

<EcGrid TItem="CultureInfo" TableContainerCssClass="table-responsive" DataProvider="ClientSideProcessingDataProvider" PageSize="3" @ref="grid">
    <Columns>
        <EcGridColumn TItem="CultureInfo" HeaderText="LCID" ItemTextSelector="@(item => item.LCID.ToString())" SortKeySelector="@(item => item.LCID)" IsDefaultSortColumn="true" />
        <EcGridColumn TItem="CultureInfo" HeaderText="DisplayName" ItemTextSelector="@(item => item.DisplayName)" SortKeySelector="@(item => item.DisplayName)" />
        <EcGridColumn TItem="CultureInfo" HeaderText="Name" ItemTextSelector="@(item => item.Name)" SortKeySelector="@(item => item.Name)" />
        <EcGridColumn TItem="CultureInfo" HeaderText="EnglishName" ItemTextSelector="@(item => item.EnglishName)" SortKeySelector="@(item => item.EnglishName)" />
        <EcContextMenuGridColumn Context="item">
            <EcContextMenu>
                <h1>@item.DisplayName</h1>
                <EcContextMenuItem Text="Delete" Icon="BootstrapIcon.Trash" OnClick="() => DeleteItem(item)" />
                <EcContextMenuItem Text="Clone" Icon="BootstrapIcon.Plus" OnClick="() => CloneItem(item)" />
            </EcContextMenu>
        </EcContextMenuGridColumn>
    </Columns>
</EcGrid>

@code {
    private List<CultureInfo> localCultureInfos = CultureInfo.GetCultures(CultureTypes.AllCultures).ToList();
    private EcGrid<CultureInfo> grid;

    private Task<GridDataProviderResult<CultureInfo>> ClientSideProcessingDataProvider(GridDataProviderRequest<CultureInfo> request)
    {
        return Task.FromResult(request.ApplyTo(localCultureInfos));
    }

    private async Task DeleteItem(CultureInfo item)
    {
        localCultureInfos.Remove(item);
        await grid.RefreshDataAsync();
    }

    private async Task CloneItem(CultureInfo item)
    {
        localCultureInfos.Add(item);
        await grid.RefreshDataAsync();
    }
}
