@page "/EcGrid_Issue199_Test"

<h3>Issue 199</h3>

<EcGrid TItem="IssueItem" DataProvider="GetData">
    <Columns>
        <EcGridColumn TItem="IssueItem" HeaderText="Number">
            <ItemTemplate>
                @context.Number
            </ItemTemplate>
        </EcGridColumn>
        <EcGridColumn TItem="IssueItem" HeaderText="Text">
            <ItemTemplate>
                @context.Text
            </ItemTemplate>
        </EcGridColumn>
    </Columns>
</EcGrid>

<EcButton Text="Modify data instances" Color="ThemeColor.Primary" OnClick="HandleModifyDataInstancesClick" />

@code {
    private List<IssueItem> demos = new List<IssueItem>
    {
        new IssueItem { Number = 1, Text = "One" },
        new IssueItem { Number = 2, Text = "Two" },
        new IssueItem { Number = 3, Text = "Three" },
    };

    private Task<GridDataProviderResult<IssueItem>> GetData(GridDataProviderRequest<IssueItem> request)
    {
        return Task.FromResult(request.ApplyTo(demos));
    }

    private void HandleModifyDataInstancesClick()
    {
        // I change the data and expect update in UI.
        // The UI is changed with or without ContentUpdateRenderer usage in the EcGrid
        foreach (IssueItem demoItem in demos)
        {
            demoItem.Number *= 10;
            demoItem.Text += "!";
        }
    }

    private class IssueItem
    {
        public int Number { get; set; }
        public string Text { get; set; }
    }
}
