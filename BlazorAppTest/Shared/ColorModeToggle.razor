@using Microsoft.JSInterop;

<EcDropdownButtonGroup CssClass="align-self-center ms-auto">
	<EcDropdownToggleButton Outline="true" Color="ThemeColor.Primary">Color mode</EcDropdownToggleButton>
	<EcDropdownMenu>
		<EcDropdownItem OnClick="() => SetColorModeAsync(ColorMode.Dark)">Dark color mode</EcDropdownItem>
		<EcDropdownItem OnClick="() => SetColorModeAsync(ColorMode.Light)">Light color mode</EcDropdownItem>
	</EcDropdownMenu>
</EcDropdownButtonGroup>

@code {
	[Inject] protected IJSRuntime JSRuntime { get; set; }

	private IJSObjectReference jsModule;

	protected override async Task OnAfterRenderAsync(bool firstRender)
	{
		await base.OnAfterRenderAsync(firstRender);

		if (firstRender)
		{
			jsModule = await JSRuntime.ImportModuleAsync("./Shared/ColorModeToggle.razor.js", typeof(ColorMode).Assembly);
		}
	}

	private ValueTask SetColorModeAsync(ColorMode colorMode)
	{
		return jsModule.InvokeVoidAsync("setTheme", colorMode.ToString("f").ToLowerInvariant());
	}
}